url,repository_url,labels_url,comments_url,events_url,html_url,id,node_id,number,title,user,labels,state,locked,assignee,assignees,milestone,comments,created_at,updated_at,closed_at,author_association,active_lock_reason,body,performed_via_github_app,pull_request
https://api.github.com/repos/pandas-dev/pandas/issues/41856,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41856/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41856/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41856/events,https://github.com/pandas-dev/pandas/issues/41856,913805034,MDU6SXNzdWU5MTM4MDUwMzQ=,41856,"API: astype(""string"") behavior","{'login': 'simonjayhawkins', 'id': 13159005, 'node_id': 'MDQ6VXNlcjEzMTU5MDA1', 'avatar_url': 'https://avatars.githubusercontent.com/u/13159005?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/simonjayhawkins', 'html_url': 'https://github.com/simonjayhawkins', 'followers_url': 'https://api.github.com/users/simonjayhawkins/followers', 'following_url': 'https://api.github.com/users/simonjayhawkins/following{/other_user}', 'gists_url': 'https://api.github.com/users/simonjayhawkins/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/simonjayhawkins/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/simonjayhawkins/subscriptions', 'organizations_url': 'https://api.github.com/users/simonjayhawkins/orgs', 'repos_url': 'https://api.github.com/users/simonjayhawkins/repos', 'events_url': 'https://api.github.com/users/simonjayhawkins/events{/privacy}', 'received_events_url': 'https://api.github.com/users/simonjayhawkins/received_events', 'type': 'User', 'site_admin': False}","[{'id': 35818298, 'node_id': 'MDU6TGFiZWwzNTgxODI5OA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/API%20Design', 'name': 'API Design', 'color': 'AD7FA8', 'default': False, 'description': None}, {'id': 57522093, 'node_id': 'MDU6TGFiZWw1NzUyMjA5Mw==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Strings', 'name': 'Strings', 'color': '5319e7', 'default': False, 'description': 'String extension data type and string data'}]",open,False,,[],,0,2021-06-07T17:54:45Z,2021-06-07T17:54:45Z,,MEMBER,,"in https://github.com/pandas-dev/pandas/pull/39908#issuecomment-855889758 @jorisvandenbossche wrote

---

Bringing the ""deferred"" storage mode lookup for `StringDtype` discussion (originally here: https://github.com/pandas-dev/pandas/pull/39908#discussion_r585573328) in the main thread, and trying to recap.

Currently, doing `pd.StringDtype()` (without specifying the storage), will already look up the option. In the default case, you get:

```python
>>> pd.StringDtype().storage
'python'
```

which also means that `pandas_dtype()` already ""fully initializes"" the string dtype:

```python
>>> pd.api.types.pandas_dtype(""string"")
string[python]
```

As a consequence, doing `astype(""string"")` will actually convert the values if your string dtype doesn't match the globab setting:

```python
>>> s = pd.Series(['a', 'b'], dtype=pd.StringDtype(storage=""pyarrow""))
>>> s.dtype
string[pyarrow]
>>> s.astype(""string"").dtype
string[python]
```

While I think it could make sense for `.astype(""string"")` to mean: ""ensure I have *a* string dtype"", and thus don't convert to another storage backend if I already had a string dtype to start with. 

We do something similar for CategoricalDtype (`""category""` means a categorical dtype with no categories, but `astype(""category"")` does not remove your categories, it preserves any existing categorical dtype as is). 

We could still have the `astype(""string"")` behave in the way I suggest by special casing this in the `astype` implementations (as suggested in https://github.com/pandas-dev/pandas/pull/39908#discussion_r643867763)), but I think that's something we would ideally avoid (any `astype` implementation accepting string dtype values as input would need to handle this case?)",,
https://api.github.com/repos/pandas-dev/pandas/issues/41855,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41855/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41855/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41855/events,https://github.com/pandas-dev/pandas/issues/41855,913731175,MDU6SXNzdWU5MTM3MzExNzU=,41855,pandas.notnull documentation showing code examples from pandas.notna,"{'login': 'jenkc', 'id': 24850405, 'node_id': 'MDQ6VXNlcjI0ODUwNDA1', 'avatar_url': 'https://avatars.githubusercontent.com/u/24850405?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jenkc', 'html_url': 'https://github.com/jenkc', 'followers_url': 'https://api.github.com/users/jenkc/followers', 'following_url': 'https://api.github.com/users/jenkc/following{/other_user}', 'gists_url': 'https://api.github.com/users/jenkc/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jenkc/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jenkc/subscriptions', 'organizations_url': 'https://api.github.com/users/jenkc/orgs', 'repos_url': 'https://api.github.com/users/jenkc/repos', 'events_url': 'https://api.github.com/users/jenkc/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jenkc/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}, {'id': 2822342, 'node_id': 'MDU6TGFiZWwyODIyMzQy', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Missing-data', 'name': 'Missing-data', 'color': 'd7e102', 'default': False, 'description': None}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/32', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/32', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/32/labels', 'id': 933188, 'node_id': 'MDk6TWlsZXN0b25lOTMzMTg4', 'number': 32, 'title': 'Contributions Welcome', 'description': 'Changes that would be nice to have in the next release. These issues are not blocking. They will be pushed to the next release if no one has time to fix them.', 'creator': {'login': 'jreback', 'id': 953992, 'node_id': 'MDQ6VXNlcjk1Mzk5Mg==', 'avatar_url': 'https://avatars.githubusercontent.com/u/953992?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jreback', 'html_url': 'https://github.com/jreback', 'followers_url': 'https://api.github.com/users/jreback/followers', 'following_url': 'https://api.github.com/users/jreback/following{/other_user}', 'gists_url': 'https://api.github.com/users/jreback/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jreback/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jreback/subscriptions', 'organizations_url': 'https://api.github.com/users/jreback/orgs', 'repos_url': 'https://api.github.com/users/jreback/repos', 'events_url': 'https://api.github.com/users/jreback/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jreback/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 1070, 'closed_issues': 719, 'state': 'open', 'created_at': '2015-01-13T10:53:19Z', 'updated_at': '2021-06-07T16:47:40Z', 'due_on': None, 'closed_at': None}",2,2021-06-07T16:28:36Z,2021-06-07T16:52:46Z,,NONE,,"The code examples are from the previous page in the documentation. Need examples for using notnull please.
Thanks!

https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.notnull.html",,
https://api.github.com/repos/pandas-dev/pandas/issues/41854,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41854/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41854/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41854/events,https://github.com/pandas-dev/pandas/pull/41854,913687725,MDExOlB1bGxSZXF1ZXN0NjYzNjgyMzU2,41854,BUG/ENH: group cummin/max handle skipna,"{'login': 'mzeitlin11', 'id': 37011898, 'node_id': 'MDQ6VXNlcjM3MDExODk4', 'avatar_url': 'https://avatars.githubusercontent.com/u/37011898?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mzeitlin11', 'html_url': 'https://github.com/mzeitlin11', 'followers_url': 'https://api.github.com/users/mzeitlin11/followers', 'following_url': 'https://api.github.com/users/mzeitlin11/following{/other_user}', 'gists_url': 'https://api.github.com/users/mzeitlin11/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mzeitlin11/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mzeitlin11/subscriptions', 'organizations_url': 'https://api.github.com/users/mzeitlin11/orgs', 'repos_url': 'https://api.github.com/users/mzeitlin11/repos', 'events_url': 'https://api.github.com/users/mzeitlin11/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mzeitlin11/received_events', 'type': 'User', 'site_admin': False}","[{'id': 57296398, 'node_id': 'MDU6TGFiZWw1NzI5NjM5OA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Algos', 'name': 'Algos', 'color': 'eb6420', 'default': False, 'description': 'Non-arithmetic algos: value_counts, factorize, sorting, isin, clip, shift, diff'}, {'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 233160, 'node_id': 'MDU6TGFiZWwyMzMxNjA=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Groupby', 'name': 'Groupby', 'color': '729FCF', 'default': False, 'description': None}, {'id': 2822342, 'node_id': 'MDU6TGFiZWwyODIyMzQy', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Missing-data', 'name': 'Missing-data', 'color': 'd7e102', 'default': False, 'description': None}]",open,False,,[],,0,2021-06-07T15:38:49Z,2021-06-07T15:57:37Z,,MEMBER,,"- [x] xref #34047
- [x] tests added / passed
- [x] Ensure all linting tests pass, see [here](https://pandas.pydata.org/pandas-docs/dev/development/contributing.html#code-standards) for how to run them
- [x] whatsnew entry

Built on #41853

Previously `skipna` was just ignored, so there was a behavior difference between cummin/max and other cumulative functions eg

```
>>> df = pd.DataFrame({""a"": [1, np.nan, 1]})
>>> df.groupby([1, 1, 1]).cumsum(skipna=False)
     a
0  1.0
1  NaN
2  NaN
>>> df.groupby([1, 1, 1]).cummax(skipna=False)
     a
0  1.0
1  NaN
2  1.0
```

Benchmarks unaffected:
<details>

```
       before           after         ratio
     [3f67dc33]       [3c869ce4]
     <master>         <group_cummin_max_skipna>
         21.9±1ms         21.1±2ms     0.96  groupby.CumminMax.time_frame_transform('Float64', 'cummax')
         22.8±2ms         23.4±2ms     1.02  groupby.CumminMax.time_frame_transform('Float64', 'cummin')
         19.3±4ms         18.1±1ms     0.94  groupby.CumminMax.time_frame_transform('Int64', 'cummax')
         26.3±2ms         22.2±3ms    ~0.84  groupby.CumminMax.time_frame_transform('Int64', 'cummin')
       19.7±0.7ms         13.7±1ms    ~0.70  groupby.CumminMax.time_frame_transform('float64', 'cummax')
         16.4±1ms       13.9±0.2ms    ~0.84  groupby.CumminMax.time_frame_transform('float64', 'cummin')
         34.6±3ms         31.1±4ms    ~0.90  groupby.CumminMax.time_frame_transform('int64', 'cummax')
       30.5±0.6ms       29.1±0.4ms     0.95  groupby.CumminMax.time_frame_transform('int64', 'cummin')
         23.3±2ms         21.0±3ms    ~0.90  groupby.CumminMax.time_frame_transform_many_nulls('Float64', 'cummax')
         21.1±3ms         21.3±3ms     1.01  groupby.CumminMax.time_frame_transform_many_nulls('Float64', 'cummin')
         21.1±1ms         22.2±2ms     1.06  groupby.CumminMax.time_frame_transform_many_nulls('Int64', 'cummax')
         19.7±2ms         20.1±3ms     1.02  groupby.CumminMax.time_frame_transform_many_nulls('Int64', 'cummin')
       16.1±0.8ms         13.6±1ms    ~0.85  groupby.CumminMax.time_frame_transform_many_nulls('float64', 'cummax')
         13.9±1ms       14.0±0.8ms     1.01  groupby.CumminMax.time_frame_transform_many_nulls('float64', 'cummin')
         15.8±1ms       14.2±0.2ms    ~0.90  groupby.CumminMax.time_frame_transform_many_nulls('int64', 'cummax')
       15.0±0.6ms       16.6±0.9ms    ~1.11  groupby.CumminMax.time_frame_transform_many_nulls('int64', 'cummin')
```

</details>",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41854', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41854', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41854.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41854.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41853,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41853/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41853/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41853/events,https://github.com/pandas-dev/pandas/pull/41853,913659822,MDExOlB1bGxSZXF1ZXN0NjYzNjU4Mjkw,41853,REF: split out grouped masked cummin/max algo,"{'login': 'mzeitlin11', 'id': 37011898, 'node_id': 'MDQ6VXNlcjM3MDExODk4', 'avatar_url': 'https://avatars.githubusercontent.com/u/37011898?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mzeitlin11', 'html_url': 'https://github.com/mzeitlin11', 'followers_url': 'https://api.github.com/users/mzeitlin11/followers', 'following_url': 'https://api.github.com/users/mzeitlin11/following{/other_user}', 'gists_url': 'https://api.github.com/users/mzeitlin11/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mzeitlin11/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mzeitlin11/subscriptions', 'organizations_url': 'https://api.github.com/users/mzeitlin11/orgs', 'repos_url': 'https://api.github.com/users/mzeitlin11/repos', 'events_url': 'https://api.github.com/users/mzeitlin11/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mzeitlin11/received_events', 'type': 'User', 'site_admin': False}","[{'id': 57296398, 'node_id': 'MDU6TGFiZWw1NzI5NjM5OA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Algos', 'name': 'Algos', 'color': 'eb6420', 'default': False, 'description': 'Non-arithmetic algos: value_counts, factorize, sorting, isin, clip, shift, diff'}, {'id': 233160, 'node_id': 'MDU6TGFiZWwyMzMxNjA=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Groupby', 'name': 'Groupby', 'color': '729FCF', 'default': False, 'description': None}, {'id': 127681, 'node_id': 'MDU6TGFiZWwxMjc2ODE=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Refactor', 'name': 'Refactor', 'color': 'FCE94F', 'default': False, 'description': 'Internal refactoring of code'}]",open,False,,[],,0,2021-06-07T15:10:59Z,2021-06-07T15:11:16Z,,MEMBER,,"No user-facing change here, but I think makes logic clearer and future changes easier to understand

Benchmarks look unaffected:
<details>

```
before           after         ratio
[3f67dc33]       [51f8f9c8]
<master>         <masked_cummin_ref>
17.0±2ms         16.3±2ms     0.96  groupby.CumminMax.time_frame_transform('Float64', 'cummax')
17.7±2ms         18.4±2ms     1.04  groupby.CumminMax.time_frame_transform('Float64', 'cummin')
20.8±3ms       16.9±0.3ms    ~0.81  groupby.CumminMax.time_frame_transform('Int64', 'cummax')
20.7±3ms         18.2±3ms    ~0.88  groupby.CumminMax.time_frame_transform('Int64', 'cummin')
15.7±2ms       13.0±0.3ms    ~0.83  groupby.CumminMax.time_frame_transform('float64', 'cummax')
15.5±0.7ms       13.6±0.7ms    ~0.88  groupby.CumminMax.time_frame_transform('float64', 'cummin')
29.8±0.7ms       28.0±0.4ms     0.94  groupby.CumminMax.time_frame_transform('int64', 'cummax')
29.9±1ms         30.0±2ms     1.00  groupby.CumminMax.time_frame_transform('int64', 'cummin')
19.2±2ms         16.9±3ms    ~0.88  groupby.CumminMax.time_frame_transform_many_nulls('Float64', 'cummax')
22.6±2ms         15.6±2ms    ~0.69  groupby.CumminMax.time_frame_transform_many_nulls('Float64', 'cummin')
15.7±3ms         19.3±3ms    ~1.23  groupby.CumminMax.time_frame_transform_many_nulls('Int64', 'cummax')
19.5±2ms         14.7±1ms    ~0.75  groupby.CumminMax.time_frame_transform_many_nulls('Int64', 'cummin')
14.5±2ms       11.4±0.8ms    ~0.79  groupby.CumminMax.time_frame_transform_many_nulls('float64', 'cummax')
13.2±1ms       12.4±0.2ms     0.94  groupby.CumminMax.time_frame_transform_many_nulls('float64', 'cummin')
14.2±1ms       13.1±0.1ms     0.92  groupby.CumminMax.time_frame_transform_many_nulls('int64', 'cummax')
14.1±0.5ms       13.4±0.4ms     0.95  groupby.CumminMax.time_frame_transform_many_nulls('int64', 'cummin')
```

</details>
",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41853', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41853', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41853.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41853.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41852,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41852/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41852/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41852/events,https://github.com/pandas-dev/pandas/pull/41852,913487621,MDExOlB1bGxSZXF1ZXN0NjYzNTEyNDIw,41852,DOC/CLN versionadded etc for 1.3 -> 1.3.0,"{'login': 'simonjayhawkins', 'id': 13159005, 'node_id': 'MDQ6VXNlcjEzMTU5MDA1', 'avatar_url': 'https://avatars.githubusercontent.com/u/13159005?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/simonjayhawkins', 'html_url': 'https://github.com/simonjayhawkins', 'followers_url': 'https://api.github.com/users/simonjayhawkins/followers', 'following_url': 'https://api.github.com/users/simonjayhawkins/following{/other_user}', 'gists_url': 'https://api.github.com/users/simonjayhawkins/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/simonjayhawkins/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/simonjayhawkins/subscriptions', 'organizations_url': 'https://api.github.com/users/simonjayhawkins/orgs', 'repos_url': 'https://api.github.com/users/simonjayhawkins/repos', 'events_url': 'https://api.github.com/users/simonjayhawkins/events{/privacy}', 'received_events_url': 'https://api.github.com/users/simonjayhawkins/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}]",open,False,,[],,0,2021-06-07T12:19:36Z,2021-06-07T12:19:36Z,,MEMBER,,,,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41852', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41852', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41852.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41852.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41851,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41851/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41851/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41851/events,https://github.com/pandas-dev/pandas/pull/41851,913449578,MDExOlB1bGxSZXF1ZXN0NjYzNDgwMjQ4,41851,DOC: remove versionadded/changed:: 0.24,"{'login': 'simonjayhawkins', 'id': 13159005, 'node_id': 'MDQ6VXNlcjEzMTU5MDA1', 'avatar_url': 'https://avatars.githubusercontent.com/u/13159005?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/simonjayhawkins', 'html_url': 'https://github.com/simonjayhawkins', 'followers_url': 'https://api.github.com/users/simonjayhawkins/followers', 'following_url': 'https://api.github.com/users/simonjayhawkins/following{/other_user}', 'gists_url': 'https://api.github.com/users/simonjayhawkins/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/simonjayhawkins/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/simonjayhawkins/subscriptions', 'organizations_url': 'https://api.github.com/users/simonjayhawkins/orgs', 'repos_url': 'https://api.github.com/users/simonjayhawkins/repos', 'events_url': 'https://api.github.com/users/simonjayhawkins/events{/privacy}', 'received_events_url': 'https://api.github.com/users/simonjayhawkins/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}]",open,False,,[],,0,2021-06-07T11:31:06Z,2021-06-07T11:31:06Z,,MEMBER,,"release Jan 25, 2019 https://github.com/pandas-dev/pandas/releases/tag/v0.24.0",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41851', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41851', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41851.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41851.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41848,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41848/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41848/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41848/events,https://github.com/pandas-dev/pandas/issues/41848,913146594,MDU6SXNzdWU5MTMxNDY1OTQ=,41848,ENH: Specify how pandas infers dtype on objects,"{'login': 'mocquin', 'id': 36188368, 'node_id': 'MDQ6VXNlcjM2MTg4MzY4', 'avatar_url': 'https://avatars.githubusercontent.com/u/36188368?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mocquin', 'html_url': 'https://github.com/mocquin', 'followers_url': 'https://api.github.com/users/mocquin/followers', 'following_url': 'https://api.github.com/users/mocquin/following{/other_user}', 'gists_url': 'https://api.github.com/users/mocquin/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mocquin/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mocquin/subscriptions', 'organizations_url': 'https://api.github.com/users/mocquin/orgs', 'repos_url': 'https://api.github.com/users/mocquin/repos', 'events_url': 'https://api.github.com/users/mocquin/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mocquin/received_events', 'type': 'User', 'site_admin': False}","[{'id': 31404521, 'node_id': 'MDU6TGFiZWwzMTQwNDUyMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Dtypes', 'name': 'Dtypes', 'color': 'e102d8', 'default': False, 'description': None}, {'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 849023693, 'node_id': 'MDU6TGFiZWw4NDkwMjM2OTM=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/ExtensionArray', 'name': 'ExtensionArray', 'color': '6138b5', 'default': False, 'description': 'Extending pandas with custom dtypes or arrays.'}]",open,False,,[],,3,2021-06-07T06:18:40Z,2021-06-07T16:38:17Z,,NONE,,"Hello there
#### Is your feature request related to a problem?

[this should provide a description of what the problem is, e.g. ""I wish I could use pandas to do [...]""]
Context : I am creating a package to handle physical units (yes, another one), and I started working on the pandas interface implementation. I looked into pandas extension page, as well as what `pint` did with `pint-pandas`. I am pretty satisfied with the result, except for one thing : When creating pandas objects (Series of DataFrame), I have to explicitly specify what dtype (using my DtypeExtension for my ""Quantity"" class) pandas should use to cast my Quantity object to the correspond QuantityArrayExtension. Categorical objects kinda exhibit the same problem : 
```python
# create indeed a Categorical dtype
s = pd.Series([""a"", ""b"", ""c"", ""a""], dtype=""category"")
# use ""object"" as dtype
pd.Series([""a"", ""b"", ""c"", ""a""])

from physipy import m # import the ""meter"" object
from physipy import QuantityDtype # import the DtypeExtension for Quantity object
# create indeed a QuantityDtype serie
s = pd.Series([1, 2, 3]*m, dtype=DtypeExtension)

# casts into integers, dropping the ""unit"" (because bypasses my object by accessing its ""array"" value directly
pd.Series([1, 2, 3]*m)
```
Now, I understand that for the Categorical example, it is not obvious what kind of dtype pandas should use, but for my custom class, I would like to be able to tell pandas how to behave.

#### Describe the solution you'd like

I would expect some interface like this :
```python
import pandas as pd
from physipy import Quantity, QuantityDtype

# tell pandas to use QuantityDtype when a Quantity object is passed
pd.dtype_lut[Quantity] = QuantityDtype

# then a series can be created directly 
my_quantity_object = [1, 2, 3]*m # this is a Quantity object
s = pd.Series(my_quantity_object)) # note the absence of dtype specification
```
Here, pandas admits it doesn't know the passed object's type, and so check in its `dtype_lut` if a corresponding dtype is set.


Another interface would be to add a method, pandas-specifically named, to Quantity that does this look-up table : 

```python
# into my Quantity object
class Quantity:
    ....

    def pd_dtype(self):
        return QuantityDtype

```
so that when pandas encounters an unknown object type, it first tries to get its Dtype using ""obj.pd_type()""

Cheers

",,
https://api.github.com/repos/pandas-dev/pandas/issues/41847,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41847/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41847/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41847/events,https://github.com/pandas-dev/pandas/issues/41847,913115674,MDU6SXNzdWU5MTMxMTU2NzQ=,41847,BUG: Unable to create DateOffset from two dates,"{'login': 'davidwales', 'id': 55477181, 'node_id': 'MDQ6VXNlcjU1NDc3MTgx', 'avatar_url': 'https://avatars.githubusercontent.com/u/55477181?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/davidwales', 'html_url': 'https://github.com/davidwales', 'followers_url': 'https://api.github.com/users/davidwales/followers', 'following_url': 'https://api.github.com/users/davidwales/following{/other_user}', 'gists_url': 'https://api.github.com/users/davidwales/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/davidwales/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/davidwales/subscriptions', 'organizations_url': 'https://api.github.com/users/davidwales/orgs', 'repos_url': 'https://api.github.com/users/davidwales/repos', 'events_url': 'https://api.github.com/users/davidwales/events{/privacy}', 'received_events_url': 'https://api.github.com/users/davidwales/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2021-06-07T05:38:29Z,2021-06-07T06:29:13Z,,CONTRIBUTOR,,"- [x] I have checked that this issue has not already been reported.

- [x] I have confirmed this bug exists on the latest version of pandas.

- [ ] (optional) I have confirmed this bug exists on the master branch of pandas.

---

#### Code Sample, a copy-pastable example

I'm trying to replicate the behaviour of `dateutil.relativedelta.relativedelta` using pandas `DateOffset`.
With regular Python + dateutil, I would do this:

```python
In [1]: from datetime import date
In [2]: from dateutil.relativedelta import relativedelta

In [3]: date_of_birth = date(1992, 1, 1)
In [4]: today = date(2021, 6, 7)
In [5]: relativedelta(today, date_of_birth)
Out[5]: relativedelta(years=+29, months=+5, days=+6)
```

However, when I try to do the same with `DateOffset`, I get an error:

``` python
In [1]: import pandas as pd
In [2]: df = pd.DataFrame({'date_of_birth': pd.to_datetime(['1992-01-01', '1994-03-18']), 'today': date.today()})
In [3]: df
Out[3]:
  date_of_birth       today
0    1992-01-01  2021-06-07
1    1994-03-18  2021-06-07

In [4]: pd.tseries.offsets.DateOffset(df['today'], df['date_of_birth'])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
pandas\_libs\tslibs\offsets.pyx in pandas._libs.tslibs.offsets.BaseOffset._validate_n()

c:\users\dwales\.local\pipx\venvs\jupyterlab\lib\site-packages\pandas\core\series.py in wrapper(self)
    140             return converter(self.iloc[0])
--> 141         raise TypeError(f""cannot convert the series to {converter}"")
    142

TypeError: cannot convert the series to <class 'int'>

During handling of the above exception, another exception occurred:

TypeError                                 Traceback (most recent call last)
<ipython-input-36-429217dd8eab> in <module>
----> 1 pd.tseries.offsets.DateOffset(df['today'], df['date_of_birth'])

pandas\_libs\tslibs\offsets.pyx in pandas._libs.tslibs.offsets.RelativeDeltaOffset.__init__()

pandas\_libs\tslibs\offsets.pyx in pandas._libs.tslibs.offsets.BaseOffset.__init__()

pandas\_libs\tslibs\offsets.pyx in pandas._libs.tslibs.offsets.BaseOffset._validate_n()

TypeError: `n` argument must be an integer, got <class 'pandas.core.series.Series'>
```

#### Problem description

This is confusing to me, because the docs for `DateOffset` say:

> Works exactly like relativedelta in terms of the keyword args you pass in

I'm guessing the issue is that [`relativedelta` has two distinct modes of operation](https://dateutil.readthedocs.io/en/latest/relativedelta.html).
The first mode expects two datetime or date instances as positional arguments, and returns a `relativedelta` between them.
The second mode expects relative years, months, days, etc as keyword arguments and allows you to manually construct a required `relativedelta`.

So far as I can tell, `DateOffset` operates similarly to the second (keyword argument) mode of `relativedelta`. However, I can't find anything in pandas which operates like the first (positional argument) mode.

#### Expected Output

``` python
In [3]: df
Out[3]:
  date_of_birth       today
0    1992-01-01  2021-06-07
1    1994-03-18  2021-06-07

In [4]: pd.tseries.offsets.DateOffset(df['today'], df['date_of_birth'])
Out[4]:
0     <DateOffset: days=6, months=5, years=29>
1    <DateOffset: days=20, months=2, years=27>
dtype: object
```

#### Workaround

``` python
In [5]: df.apply(lambda df: relativedelta(df['today'], df['date_of_birth']), axis=1)
Out[5]:
0     relativedelta(years=+29, months=+5, days=+6)
1    relativedelta(years=+27, months=+2, days=+20)
dtype: object
```

If you have `NaT` values in your data, you will need to handle them:

``` python
df.apply(lambda df: relativedelta(df['today'], df['date_of_birth'])  if (pd.notna(df['today']) & pd.notna(df['date_of_birth'])) else pd.NaT, axis=1)
```

#### Output of ``pd.show_versions()``

<details>

INSTALLED VERSIONS
------------------
commit           : 2cb96529396d93b46abab7bbc73a208e708c642e
python           : 3.9.0.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.18362
machine          : AMD64
processor        : Intel64 Family 6 Model 78 Stepping 3, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : None
LOCALE           : English_Australia.1252

pandas           : 1.2.4
numpy            : 1.19.4
pytz             : 2020.4
dateutil         : 2.8.1
pip              : 21.1.2
setuptools       : 57.0.0
Cython           : None
pytest           : None
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : None
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : 2.11.2
IPython          : 7.19.0
pandas_datareader: None
bs4              : None
bottleneck       : None
fsspec           : None
fastparquet      : None
gcsfs            : None
matplotlib       : 3.4.2
numexpr          : None
odfpy            : None
openpyxl         : 3.0.7
pandas_gbq       : None
pyarrow          : 4.0.1
pyxlsb           : None
s3fs             : None
scipy            : None
sqlalchemy       : 1.4.17
tables           : None
tabulate         : None
xarray           : None
xlrd             : 2.0.1
xlwt             : None
numba            : None

</details>
",,
https://api.github.com/repos/pandas-dev/pandas/issues/41846,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41846/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41846/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41846/events,https://github.com/pandas-dev/pandas/pull/41846,913090148,MDExOlB1bGxSZXF1ZXN0NjYzMTY3MTI1,41846,BUG: DataFrame.at with CategoricalIndex,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 78527356, 'node_id': 'MDU6TGFiZWw3ODUyNzM1Ng==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Categorical', 'name': 'Categorical', 'color': 'e11d21', 'default': False, 'description': 'Categorical Data Type'}, {'id': 2822098, 'node_id': 'MDU6TGFiZWwyODIyMDk4', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Indexing', 'name': 'Indexing', 'color': '0b02e1', 'default': False, 'description': 'Related to indexing on series/frames, not to indexes themselves'}]",open,False,,[],,0,2021-06-07T04:59:42Z,2021-06-07T15:13:55Z,,MEMBER,,"- [ ] closes #xxxx
- [x] tests added / passed
- [x] Ensure all linting tests pass, see [here](https://pandas.pydata.org/pandas-docs/dev/development/contributing.html#code-standards) for how to run them
- [ ] whatsnew entry
",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41846', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41846', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41846.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41846.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41845,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41845/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41845/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41845/events,https://github.com/pandas-dev/pandas/pull/41845,913042785,MDExOlB1bGxSZXF1ZXN0NjYzMTI3NjYy,41845,"docstrings: typos, consistence, clarity","{'login': 'stragu', 'id': 1747497, 'node_id': 'MDQ6VXNlcjE3NDc0OTc=', 'avatar_url': 'https://avatars.githubusercontent.com/u/1747497?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/stragu', 'html_url': 'https://github.com/stragu', 'followers_url': 'https://api.github.com/users/stragu/followers', 'following_url': 'https://api.github.com/users/stragu/following{/other_user}', 'gists_url': 'https://api.github.com/users/stragu/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/stragu/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/stragu/subscriptions', 'organizations_url': 'https://api.github.com/users/stragu/orgs', 'repos_url': 'https://api.github.com/users/stragu/repos', 'events_url': 'https://api.github.com/users/stragu/events{/privacy}', 'received_events_url': 'https://api.github.com/users/stragu/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}]",open,False,,[],,1,2021-06-07T02:59:49Z,2021-06-07T15:28:50Z,,NONE,,"Minor changes only in docstrings: capitalisation, hyphenation, ""indexes"" -> ""indices"", typos.

- [ ] tests added / passed
- [ ] Ensure all linting tests pass, see [here](https://pandas.pydata.org/pandas-docs/dev/development/contributing.html#code-standards) for how to run them
- [ ] whatsnew entry

Apologies for not testing, as the changes are minor and only affect docstrings.
No `whatsnew` entry either because minor.",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41845', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41845', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41845.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41845.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41844,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41844/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41844/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41844/events,https://github.com/pandas-dev/pandas/pull/41844,912971086,MDExOlB1bGxSZXF1ZXN0NjYzMDY4NDEy,41844,DOC: Add .to_xyz to io docs,"{'login': 'gansel51', 'id': 59709552, 'node_id': 'MDQ6VXNlcjU5NzA5NTUy', 'avatar_url': 'https://avatars.githubusercontent.com/u/59709552?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/gansel51', 'html_url': 'https://github.com/gansel51', 'followers_url': 'https://api.github.com/users/gansel51/followers', 'following_url': 'https://api.github.com/users/gansel51/following{/other_user}', 'gists_url': 'https://api.github.com/users/gansel51/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/gansel51/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/gansel51/subscriptions', 'organizations_url': 'https://api.github.com/users/gansel51/orgs', 'repos_url': 'https://api.github.com/users/gansel51/repos', 'events_url': 'https://api.github.com/users/gansel51/events{/privacy}', 'received_events_url': 'https://api.github.com/users/gansel51/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}]",open,False,,[],,4,2021-06-06T23:03:59Z,2021-06-07T17:18:35Z,,NONE,,"- [x] closes #41839
- [ ] tests added / passed
- [x] Ensure all linting tests pass, see [here](https://pandas.pydata.org/pandas-docs/dev/development/contributing.html#code-standards) for how to run them
- [ ] whatsnew entry

Screenshot below for updated docs

<img width=""558"" alt=""Screen Shot 2021-06-06 at 7 03 23 PM"" src=""https://user-images.githubusercontent.com/59709552/120942916-e53bf400-c6f9-11eb-96bc-d16dc852f45c.png"">
",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41844', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41844', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41844.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41844.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41843,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41843/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41843/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41843/events,https://github.com/pandas-dev/pandas/issues/41843,912969939,MDU6SXNzdWU5MTI5Njk5Mzk=,41843,BUG: `tseries.offsets.MonthEnd` is leaving out full 24h of period,"{'login': 'avibrazil', 'id': 3484242, 'node_id': 'MDQ6VXNlcjM0ODQyNDI=', 'avatar_url': 'https://avatars.githubusercontent.com/u/3484242?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/avibrazil', 'html_url': 'https://github.com/avibrazil', 'followers_url': 'https://api.github.com/users/avibrazil/followers', 'following_url': 'https://api.github.com/users/avibrazil/following{/other_user}', 'gists_url': 'https://api.github.com/users/avibrazil/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/avibrazil/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/avibrazil/subscriptions', 'organizations_url': 'https://api.github.com/users/avibrazil/orgs', 'repos_url': 'https://api.github.com/users/avibrazil/repos', 'events_url': 'https://api.github.com/users/avibrazil/events{/privacy}', 'received_events_url': 'https://api.github.com/users/avibrazil/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2021-06-06T22:58:01Z,2021-06-07T12:31:55Z,,NONE,,"#### Code Sample, a copy-pastable example

```python
>>> pd.Timestamp('2021-05-20') + pd.tseries.offsets.MonthEnd
Timestamp('2021-05-31 00:00:00')
```

`MonthEnd` gets me the first second of the last day, while I was expecting the last second of the last day of month (`Timestamp('2021-05-31 23:59:59')`). This yields strange consequences as showed below.

#### A consequence of unexpected behavior

When using `df.resample('M').ffill()` to get the last known value for a month, data for the last 24h of a month are ignored.

```python
>>> df=pd.DataFrame({'val': {
  pd.Timestamp('2021-03-24 12:03:00'): 1.0,
  pd.Timestamp('2021-03-31 12:00:00'): 1001.0,
  pd.Timestamp('2021-04-28 12:03:00'): 1.0,
  pd.Timestamp('2021-04-30 23:59:00'): 1002.0,
  pd.Timestamp('2021-05-30 00:00:01'): 1.0,
  pd.Timestamp('2021-05-31 12:00:00'): 1003.0
}})

>>> df
                        val
2021-03-24 12:03:00     1.0
2021-03-31 12:00:00  1001.0
2021-04-28 12:03:00     1.0
2021-04-30 23:59:00  1002.0
2021-05-30 00:00:01     1.0
2021-05-31 12:00:00  1003.0

>>> df.resample('M').ffill()
            val
2021-03-31  1.0
2021-04-30  1.0
2021-05-31  1.0
```

The expected behavior for the `ffill` operation is >1000 for all `MonthEnd`.

On the other hand, a `sum` operation works as expected:

```python
>>> df.resample('M').sum()
               val
2021-03-31  1002.0
2021-04-30  1003.0
2021-05-31  1004.0
```

#### Output of ``pd.show_versions()``

<details>

```
INSTALLED VERSIONS
------------------
commit           : 2cb96529396d93b46abab7bbc73a208e708c642e
python           : 3.8.2.final.0
python-bits      : 64
OS               : Darwin
OS-release       : 20.5.0
Version          : Darwin Kernel Version 20.5.0: Sat May  8 05:10:33 PDT 2021; root:xnu-7195.121.3~9/RELEASE_X86_64
machine          : x86_64
processor        : i386
byteorder        : little
LC_ALL           : None
LANG             : None
LOCALE           : en_US.UTF-8

pandas           : 1.2.4
numpy            : 1.20.1
pytz             : 2021.1
dateutil         : 2.8.1
pip              : 21.1
setuptools       : 41.2.0
Cython           : None
pytest           : None
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : 4.6.3
html5lib         : None
pymysql          : 1.0.2
psycopg2         : None
jinja2           : 2.11.3
IPython          : 7.20.0
pandas_datareader: 0.9.0
bs4              : 4.9.3
bottleneck       : None
fsspec           : None
fastparquet      : None
gcsfs            : None
matplotlib       : 3.3.4
numexpr          : None
odfpy            : None
openpyxl         : 3.0.7
pandas_gbq       : None
pyarrow          : 3.0.0
pyxlsb           : None
s3fs             : None
scipy            : 1.6.1
sqlalchemy       : 1.3.23
tables           : None
tabulate         : None
xarray           : None
xlrd             : 2.0.1
xlwt             : None
numba            : 0.53.1
```

</details>
",,
https://api.github.com/repos/pandas-dev/pandas/issues/41842,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41842/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41842/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41842/events,https://github.com/pandas-dev/pandas/pull/41842,912952699,MDExOlB1bGxSZXF1ZXN0NjYzMDUzNTMx,41842,DOC: reverse rolling window (#38627),"{'login': 'mdhsieh', 'id': 52055110, 'node_id': 'MDQ6VXNlcjUyMDU1MTEw', 'avatar_url': 'https://avatars.githubusercontent.com/u/52055110?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mdhsieh', 'html_url': 'https://github.com/mdhsieh', 'followers_url': 'https://api.github.com/users/mdhsieh/followers', 'following_url': 'https://api.github.com/users/mdhsieh/following{/other_user}', 'gists_url': 'https://api.github.com/users/mdhsieh/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mdhsieh/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mdhsieh/subscriptions', 'organizations_url': 'https://api.github.com/users/mdhsieh/orgs', 'repos_url': 'https://api.github.com/users/mdhsieh/repos', 'events_url': 'https://api.github.com/users/mdhsieh/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mdhsieh/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}, {'id': 1045950827, 'node_id': 'MDU6TGFiZWwxMDQ1OTUwODI3', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Window', 'name': 'Window', 'color': 'd4c5f9', 'default': False, 'description': 'rolling, ewma, expanding'}]",open,False,,[],,0,2021-06-06T21:27:49Z,2021-06-07T17:52:18Z,,CONTRIBUTOR,,"This adds the suggested changes from closed pull request (#38627):
https://github.com/pandas-dev/pandas/pull/39091/files/80819f65402e46caa29ff7192b34d43f91c1a0ee
After updated commit.
- remove noqa
- change line back to single quotes
- rename `df1` to `reversed_df`
- add reference to `FixedForwardWindowIndexer`
- remove repeated `df` initialization in code example
- rename `df2` to `reversed_df`
- move code example

- [x] closes #38627
- [ ] tests added / passed
- [x] Ensure all linting tests pass, see [here](https://pandas.pydata.org/pandas-docs/dev/development/contributing.html#code-standards) for how to run them
- [ ] whatsnew entry
",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41842', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41842', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41842.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41842.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41841,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41841/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41841/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41841/events,https://github.com/pandas-dev/pandas/pull/41841,912948011,MDExOlB1bGxSZXF1ZXN0NjYzMDQ5NzI2,41841,TYP: use annotations in strprime.pyi and timestamps.pyi,"{'login': 'fangchenli', 'id': 7614606, 'node_id': 'MDQ6VXNlcjc2MTQ2MDY=', 'avatar_url': 'https://avatars.githubusercontent.com/u/7614606?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/fangchenli', 'html_url': 'https://github.com/fangchenli', 'followers_url': 'https://api.github.com/users/fangchenli/followers', 'following_url': 'https://api.github.com/users/fangchenli/following{/other_user}', 'gists_url': 'https://api.github.com/users/fangchenli/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/fangchenli/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/fangchenli/subscriptions', 'organizations_url': 'https://api.github.com/users/fangchenli/orgs', 'repos_url': 'https://api.github.com/users/fangchenli/repos', 'events_url': 'https://api.github.com/users/fangchenli/events{/privacy}', 'received_events_url': 'https://api.github.com/users/fangchenli/received_events', 'type': 'User', 'site_admin': False}","[{'id': 1280988427, 'node_id': 'MDU6TGFiZWwxMjgwOTg4NDI3', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Typing', 'name': 'Typing', 'color': 'ea91a4', 'default': False, 'description': 'mypy type annotations'}]",open,False,,[],,0,2021-06-06T21:04:36Z,2021-06-06T21:08:55Z,,MEMBER,,,,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41841', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41841', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41841.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41841.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41839,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41839/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41839/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41839/events,https://github.com/pandas-dev/pandas/issues/41839,912883108,MDU6SXNzdWU5MTI4ODMxMDg=,41839,DOC: Input/Output page contains only input functions,"{'login': 'attack68', 'id': 24256554, 'node_id': 'MDQ6VXNlcjI0MjU2NTU0', 'avatar_url': 'https://avatars.githubusercontent.com/u/24256554?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/attack68', 'html_url': 'https://github.com/attack68', 'followers_url': 'https://api.github.com/users/attack68/followers', 'following_url': 'https://api.github.com/users/attack68/following{/other_user}', 'gists_url': 'https://api.github.com/users/attack68/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/attack68/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/attack68/subscriptions', 'organizations_url': 'https://api.github.com/users/attack68/orgs', 'repos_url': 'https://api.github.com/users/attack68/repos', 'events_url': 'https://api.github.com/users/attack68/events{/privacy}', 'received_events_url': 'https://api.github.com/users/attack68/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}, {'id': 717120670, 'node_id': 'MDU6TGFiZWw3MTcxMjA2NzA=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/good%20first%20issue', 'name': 'good first issue', 'color': '0e8a16', 'default': True, 'description': None}]",open,False,,[],,1,2021-06-06T16:36:13Z,2021-06-06T23:06:25Z,,CONTRIBUTOR,,"#### Location of the documentation

https://pandas.pydata.org/pandas-docs/dev/reference/io.html#html

#### Documentation problem

The title is Input/Output but all linked methods are `read_xyz()`, and there is little if any reference to any `write_xyz()` or `to_xyzz methods.

#### Suggested fix for documentation

Perform a review and enure all input/output methods are referenced on the page.
",,
https://api.github.com/repos/pandas-dev/pandas/issues/41838,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41838/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41838/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41838/events,https://github.com/pandas-dev/pandas/issues/41838,912722673,MDU6SXNzdWU5MTI3MjI2NzM=,41838,ENH: Using transparentpath in read_csv,"{'login': 'michaelshekasta', 'id': 41590425, 'node_id': 'MDQ6VXNlcjQxNTkwNDI1', 'avatar_url': 'https://avatars.githubusercontent.com/u/41590425?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/michaelshekasta', 'html_url': 'https://github.com/michaelshekasta', 'followers_url': 'https://api.github.com/users/michaelshekasta/followers', 'following_url': 'https://api.github.com/users/michaelshekasta/following{/other_user}', 'gists_url': 'https://api.github.com/users/michaelshekasta/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/michaelshekasta/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/michaelshekasta/subscriptions', 'organizations_url': 'https://api.github.com/users/michaelshekasta/orgs', 'repos_url': 'https://api.github.com/users/michaelshekasta/repos', 'events_url': 'https://api.github.com/users/michaelshekasta/events{/privacy}', 'received_events_url': 'https://api.github.com/users/michaelshekasta/received_events', 'type': 'User', 'site_admin': False}","[{'id': 2365504893, 'node_id': 'MDU6TGFiZWwyMzY1NTA0ODkz', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Closing%20Candidate', 'name': 'Closing Candidate', 'color': 'be21f2', 'default': False, 'description': 'May be closeable, needs more eyeballs'}, {'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 2301354, 'node_id': 'MDU6TGFiZWwyMzAxMzU0', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/IO%20Data', 'name': 'IO Data', 'color': '06909A', 'default': False, 'description': ""IO issues that don't fit into a more specific label""}]",open,False,,[],,1,2021-06-06T08:41:07Z,2021-06-06T19:36:33Z,,NONE,,"Hi Guys,

First of all, Thanks for your work!  I wish I could use pandas with transparentpath in read_csv function.
In short, transparentpath can contain gscfs paths and local paths.
for more information see [this example](https://towardsdatascience.com/transparentpath-a-python-package-to-manage-paths-on-google-cloud-storage-ae25a15a44d5)

Thanks,
Michael",,
https://api.github.com/repos/pandas-dev/pandas/issues/41837,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41837/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41837/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41837/events,https://github.com/pandas-dev/pandas/issues/41837,912620024,MDU6SXNzdWU5MTI2MjAwMjQ=,41837,ENH: DataFrame.to_expr() method,"{'login': 'kerrickstaley', 'id': 184773, 'node_id': 'MDQ6VXNlcjE4NDc3Mw==', 'avatar_url': 'https://avatars.githubusercontent.com/u/184773?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/kerrickstaley', 'html_url': 'https://github.com/kerrickstaley', 'followers_url': 'https://api.github.com/users/kerrickstaley/followers', 'following_url': 'https://api.github.com/users/kerrickstaley/following{/other_user}', 'gists_url': 'https://api.github.com/users/kerrickstaley/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/kerrickstaley/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/kerrickstaley/subscriptions', 'organizations_url': 'https://api.github.com/users/kerrickstaley/orgs', 'repos_url': 'https://api.github.com/users/kerrickstaley/repos', 'events_url': 'https://api.github.com/users/kerrickstaley/events{/privacy}', 'received_events_url': 'https://api.github.com/users/kerrickstaley/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,1,2021-06-06T04:48:43Z,2021-06-07T17:37:43Z,,NONE,,"#### Is your feature request related to a problem?

I would like to write some unit tests for my Pandas code. I want to test that some `DataFrame` is equal to an expected value. The expected value is complicated and I would like an easy way to get the Python code to construct it. My program already computes the expected `DataFrame` value but I need a way to serialize/deserialize it for use in my test code.

[Here is a StackOverflow question with more detail](https://stackoverflow.com/questions/67845199/how-can-i-get-a-repr-of-a-dataframe-that-is-a-valid-python-expression).

#### Describe the solution you'd like

I would like there to be a `DataFrame.to_expr()` method. It should return a `str` containing valid Python code that can be used to re-construct the `DataFrame`.

To the greatest extent possible, it should be true that `pd.testing.assert_frame_equal(df1, eval(df2.to_expr()))` throws an `AssertionError` if and only if `pd.testing.assert_frame_equal(df1, df2)` throws an `AssertionError`. I am using `assert_frame_equal` because it checks column dtypes, whereas `DataFrame.equals()` does not.

Concretely, I think the return value of `.to_expr()` should be something like
```
pandas.DataFrame({'column_1': pandas.Series([1, 2, 3], dtype='int64'), 'column_2': pandas.Series([1.0, 2.0, 3.0], dtype='float64')})
```

Note that on many Python objects, this `.to_expr()` method is called `__repr__()`. [The Python docs state:](https://docs.python.org/3/library/functions.html#repr)
> For many types, [`__repr__`] makes an attempt to return a string that would yield an object with the same value when passed to `eval()`...

However, `DataFrame.__repr__` is already defined to print a different representation (which **is** arguably more useful in an interactive environment).

#### API breaking implications

This is a backwards-compatible change.

#### Describe alternatives you've considered

I've used `DataFrame.to_dict()` and `DataFrame.from_dict()` for this purpose in the past. However, this doesn't preserve the type, and so it doesn't work if you're working with an empty `DataFrame`. I also worry that `from_dict` will sometimes fail to infer the original type even for non-empty `DataFrame`s.
",,
https://api.github.com/repos/pandas-dev/pandas/issues/41836,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41836/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41836/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41836/events,https://github.com/pandas-dev/pandas/issues/41836,912602114,MDU6SXNzdWU5MTI2MDIxMTQ=,41836,_libs.hashtable.ismember incorrect with tuples containing nan,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,1,2021-06-06T04:02:39Z,2021-06-06T14:04:30Z,,MEMBER,,"It looks like the equality check being done on tuples is checking NA values for identity, so separately instantiated `float(""nan"")` objects aren't considered matching.

```
from pandas.core.algorithms import isin

values = [(""a"", float(""nan"")), (""b"", 1)]
comps = [(""a"", float(""nan""))]
alt = (""a"", values[0][1])

>>> isin(values, comps)
array([False, False])

>>> isin(values, [alt])
array([ True, False])
```


cc @realead ",,
https://api.github.com/repos/pandas-dev/pandas/issues/41834,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41834/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41834/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41834/events,https://github.com/pandas-dev/pandas/issues/41834,912490754,MDU6SXNzdWU5MTI0OTA3NTQ=,41834,BUG: Odd timezone offset change with old datetimes with tz_convert,"{'login': 'rok', 'id': 54589, 'node_id': 'MDQ6VXNlcjU0NTg5', 'avatar_url': 'https://avatars.githubusercontent.com/u/54589?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/rok', 'html_url': 'https://github.com/rok', 'followers_url': 'https://api.github.com/users/rok/followers', 'following_url': 'https://api.github.com/users/rok/following{/other_user}', 'gists_url': 'https://api.github.com/users/rok/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/rok/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/rok/subscriptions', 'organizations_url': 'https://api.github.com/users/rok/orgs', 'repos_url': 'https://api.github.com/users/rok/repos', 'events_url': 'https://api.github.com/users/rok/events{/privacy}', 'received_events_url': 'https://api.github.com/users/rok/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2021-06-05T23:02:57Z,2021-06-05T23:02:57Z,,CONTRIBUTOR,,"- [x] I have checked that this issue has not already been reported.

- [x] I have confirmed this bug exists on the latest version of pandas.

- [ ] (optional) I have confirmed this bug exists on the master branch of pandas.

---

**Note**: Please read [this guide](https://matthewrocklin.com/blog/work/2018/02/28/minimal-bug-reports) detailing how to provide the necessary information for us to reproduce your bug.

#### Code Sample, a copy-pastable example

```python
import pandas as pd
[
    pd.to_datetime([""1900-01-01""]).tz_localize(""UTC"").tz_convert(""Australia/Broken_Hill""),
    pd.to_datetime([""1900-01-01""]).tz_localize(""UTC"").tz_convert(""Pacific/Marquesas""),
    pd.to_datetime([""2000-01-01""]).tz_localize(""UTC"").tz_convert(""Pacific/Marquesas""),
    pd.to_datetime([""2000-01-01""]).tz_localize(""UTC"").tz_convert(""Australia/Broken_Hill""),
    pd.to_datetime([""1900-01-01""]).tz_localize(""UTC"").tz_convert(""Etc/GMT-9""),
    pd.to_datetime([""2000-01-01""]).tz_localize(""UTC"").tz_convert(""Etc/GMT-9""),
]
```
Returns:
```
[DatetimeIndex(['1900-01-01 09:26:00+09:26'], dtype='datetime64[ns, Australia/Broken_Hill]', freq=None),
 DatetimeIndex(['1899-12-31 14:42:00-09:18'], dtype='datetime64[ns, Pacific/Marquesas]', freq=None),
 DatetimeIndex(['1999-12-31 14:30:00-09:30'], dtype='datetime64[ns, Pacific/Marquesas]', freq=None),
 DatetimeIndex(['2000-01-01 10:30:00+10:30'], dtype='datetime64[ns, Australia/Broken_Hill]', freq=None),
 DatetimeIndex(['1900-01-01 09:00:00+09:00'], dtype='datetime64[ns, Etc/GMT-9]', freq=None),
 DatetimeIndex(['2000-01-01 09:00:00+09:00'], dtype='datetime64[ns, Etc/GMT-9]', freq=None)]
```

#### Problem description

Timezone offset seems to change when it shouldn't? I'm not 100% this is not the correct behavior but it seems odd.
I hope this is known behavior and not something esoteric.

#### Expected Output

Probably this:
```
[DatetimeIndex(['1900-01-01 10:30:00+10:30'], dtype='datetime64[ns, Australia/Broken_Hill]', freq=None),
 DatetimeIndex(['1899-12-31 14:30:00-09:30'], dtype='datetime64[ns, Pacific/Marquesas]', freq=None),
 DatetimeIndex(['1999-12-31 14:30:00-09:30'], dtype='datetime64[ns, Pacific/Marquesas]', freq=None),
 DatetimeIndex(['2000-01-01 10:30:00+10:30'], dtype='datetime64[ns, Australia/Broken_Hill]', freq=None),
 DatetimeIndex(['1900-01-01 09:00:00+09:00'], dtype='datetime64[ns, Etc/GMT-9]', freq=None),
 DatetimeIndex(['2000-01-01 09:00:00+09:00'], dtype='datetime64[ns, Etc/GMT-9]', freq=None)]
```

I'm not sure these timezones even existed then so this might be an invalid calculation.

#### Output of ``pd.show_versions()``

<details>

INSTALLED VERSIONS
------------------
commit           : 2cb96529396d93b46abab7bbc73a208e708c642e
python           : 3.7.0.final.0
python-bits      : 64
OS               : Linux
OS-release       : 5.4.0-73-lowlatency
Version          : #82-Ubuntu SMP PREEMPT Wed Apr 14 19:19:50 UTC 2021
machine          : x86_64
processor        : x86_64
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : en_US.UTF-8

pandas           : 1.2.4
numpy            : 1.19.1
pytz             : 2020.5
dateutil         : 2.8.1
pip              : 20.2.3
setuptools       : 50.3.0.post20201006
Cython           : None
pytest           : 6.2.1
hypothesis       : None
sphinx           : 2.4.4
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : 4.6.2
html5lib         : None
pymysql          : None
psycopg2         : 2.8.6 (dt dec pq3 ext lo64)
jinja2           : 2.11.2
IPython          : 7.18.1
pandas_datareader: None
bs4              : None
bottleneck       : None
fsspec           : None
fastparquet      : None
gcsfs            : None
matplotlib       : 3.3.1
numexpr          : None
odfpy            : None
openpyxl         : 3.0.7
pandas_gbq       : None
pyarrow          : 1.0.1
pyxlsb           : None
s3fs             : None
scipy            : 1.5.2
sqlalchemy       : 1.3.19
tables           : None
tabulate         : 0.8.7
xarray           : None
xlrd             : 2.0.1
xlwt             : None
numba            : None

</details>
",,
https://api.github.com/repos/pandas-dev/pandas/issues/41833,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41833/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41833/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41833/events,https://github.com/pandas-dev/pandas/pull/41833,912417260,MDExOlB1bGxSZXF1ZXN0NjYyNTc3ODA5,41833,"REF: de-duplicate symmetric_difference, _union","{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 1218227310, 'node_id': 'MDU6TGFiZWwxMjE4MjI3MzEw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Index', 'name': 'Index', 'color': 'e99695', 'default': False, 'description': 'Related to the Index class or subclasses'}, {'id': 2822098, 'node_id': 'MDU6TGFiZWwyODIyMDk4', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Indexing', 'name': 'Indexing', 'color': '0b02e1', 'default': False, 'description': 'Related to indexing on series/frames, not to indexes themselves'}, {'id': 127681, 'node_id': 'MDU6TGFiZWwxMjc2ODE=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Refactor', 'name': 'Refactor', 'color': 'FCE94F', 'default': False, 'description': 'Internal refactoring of code'}]",open,False,,[],,0,2021-06-05T19:53:54Z,2021-06-07T15:14:41Z,,MEMBER,,Also fixes buglet in CategoricalIndex.equals(MultiIndex),,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41833', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41833', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41833.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41833.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41832,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41832/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41832/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41832/events,https://github.com/pandas-dev/pandas/pull/41832,912416299,MDExOlB1bGxSZXF1ZXN0NjYyNTc2OTYy,41832,REF: de-duplicate IntervalIndex setops,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 1218227310, 'node_id': 'MDU6TGFiZWwxMjE4MjI3MzEw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Index', 'name': 'Index', 'color': 'e99695', 'default': False, 'description': 'Related to the Index class or subclasses'}, {'id': 2822098, 'node_id': 'MDU6TGFiZWwyODIyMDk4', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Indexing', 'name': 'Indexing', 'color': '0b02e1', 'default': False, 'description': 'Related to indexing on series/frames, not to indexes themselves'}, {'id': 127681, 'node_id': 'MDU6TGFiZWwxMjc2ODE=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Refactor', 'name': 'Refactor', 'color': 'FCE94F', 'default': False, 'description': 'Internal refactoring of code'}]",open,False,,[],,0,2021-06-05T19:51:30Z,2021-06-07T15:14:41Z,,MEMBER,,I expect we'll be able to get rid of the last ones once #41831 is fixed,,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41832', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41832', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41832.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41832.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41831,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41831/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41831/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41831/events,https://github.com/pandas-dev/pandas/issues/41831,912406932,MDU6SXNzdWU5MTI0MDY5MzI=,41831,"BUG: IntervalIndex([np.nan, np.nan]).is_monotonic returns True","{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2021-06-05T19:24:41Z,2021-06-05T19:24:41Z,,MEMBER,,"I'm pretty sure this is related to other questionable behavior:

```
index = pd.IntervalIndex([np.nan, np.nan])
other = pd.IntervalIndex([np.nan])

In [4]: index.is_monotonic  # should be False
Out[4]: True

In [5]: index._index_as_unique  # should be False
Out[5]: True

In [6]: index.get_indexer_for(other)  # shouldn't raise
InvalidIndexError: Reindexing only valid with uniquely valued Index objects
```",,
https://api.github.com/repos/pandas-dev/pandas/issues/41830,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41830/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41830/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41830/events,https://github.com/pandas-dev/pandas/pull/41830,912393075,MDExOlB1bGxSZXF1ZXN0NjYyNTU1OTMy,41830,TYP: datetimelike,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 1280988427, 'node_id': 'MDU6TGFiZWwxMjgwOTg4NDI3', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Typing', 'name': 'Typing', 'color': 'ea91a4', 'default': False, 'description': 'mypy type annotations'}]",open,False,,[],,0,2021-06-05T18:50:56Z,2021-06-07T15:13:12Z,,MEMBER,,"- [ ] closes #xxxx
- [ ] tests added / passed
- [ ] Ensure all linting tests pass, see [here](https://pandas.pydata.org/pandas-docs/dev/development/contributing.html#code-standards) for how to run them
- [ ] whatsnew entry
",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41830', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41830', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41830.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41830.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41829,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41829/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41829/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41829/events,https://github.com/pandas-dev/pandas/issues/41829,912363631,MDU6SXNzdWU5MTIzNjM2MzE=,41829,CI: Re-enable Circle CI,"{'login': 'lithomas1', 'id': 47963215, 'node_id': 'MDQ6VXNlcjQ3OTYzMjE1', 'avatar_url': 'https://avatars.githubusercontent.com/u/47963215?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/lithomas1', 'html_url': 'https://github.com/lithomas1', 'followers_url': 'https://api.github.com/users/lithomas1/followers', 'following_url': 'https://api.github.com/users/lithomas1/following{/other_user}', 'gists_url': 'https://api.github.com/users/lithomas1/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/lithomas1/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/lithomas1/subscriptions', 'organizations_url': 'https://api.github.com/users/lithomas1/orgs', 'repos_url': 'https://api.github.com/users/lithomas1/repos', 'events_url': 'https://api.github.com/users/lithomas1/events{/privacy}', 'received_events_url': 'https://api.github.com/users/lithomas1/received_events', 'type': 'User', 'site_admin': False}","[{'id': 48070600, 'node_id': 'MDU6TGFiZWw0ODA3MDYwMA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/CI', 'name': 'CI', 'color': 'a2bca7', 'default': False, 'description': 'Related to Continuous Integration'}]",open,False,,[],,0,2021-06-05T17:38:50Z,2021-06-05T17:41:45Z,,MEMBER,,"I contacted CircleCI to check if they could be interested in sponsoring our ARM builds. Will update if I hear from them. For now looks like we're getting the 2,500 credits that @lithomas1 mentioned (not the 400,000 for open source projects for Linux builds). So, not much we can do with those.

I updated this PR so we don't add the CircleCI build, but still, it has everything else so the build passes when it can be added wherever. Only thing is that we now need to disable Circle CI, so the build doesn't fail after we remove the configuration. But only an admin of the pandas-dev organization can do it. @jreback do you mind going to https://app.circleci.com/settings/project/github/pandas-dev/pandas?return-to=https%3A%2F%2Fapp.circleci.com%2Fpipelines%2Fgithub%2Fpandas-dev%2Fpandas%2F30%2Fworkflows%2Ff9a6db17-510a-4eaf-a10c-b3a800e0a6c4%2Fjobs%2F30872 and clickig on ""Stop builds"" please?

_Originally posted by @datapythonista in https://github.com/pandas-dev/pandas/issues/41739#issuecomment-852446796_

We should re-enable Circle CI if we receive the Circle CI credits. 
cc @datapythonista for updates on this",,
https://api.github.com/repos/pandas-dev/pandas/issues/41828,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41828/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41828/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41828/events,https://github.com/pandas-dev/pandas/issues/41828,912347856,MDU6SXNzdWU5MTIzNDc4NTY=,41828,ENH: retain attrs when concat dataframes,"{'login': 'xiki-tempula', 'id': 6242032, 'node_id': 'MDQ6VXNlcjYyNDIwMzI=', 'avatar_url': 'https://avatars.githubusercontent.com/u/6242032?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/xiki-tempula', 'html_url': 'https://github.com/xiki-tempula', 'followers_url': 'https://api.github.com/users/xiki-tempula/followers', 'following_url': 'https://api.github.com/users/xiki-tempula/following{/other_user}', 'gists_url': 'https://api.github.com/users/xiki-tempula/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/xiki-tempula/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/xiki-tempula/subscriptions', 'organizations_url': 'https://api.github.com/users/xiki-tempula/orgs', 'repos_url': 'https://api.github.com/users/xiki-tempula/repos', 'events_url': 'https://api.github.com/users/xiki-tempula/events{/privacy}', 'received_events_url': 'https://api.github.com/users/xiki-tempula/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 13098779, 'node_id': 'MDU6TGFiZWwxMzA5ODc3OQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Reshaping', 'name': 'Reshaping', 'color': '02d7e1', 'default': False, 'description': 'Concat, Merge/Join, Stack/Unstack'}, {'id': 1539579994, 'node_id': 'MDU6TGFiZWwxNTM5NTc5OTk0', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/metadata', 'name': 'metadata', 'color': '56efc9', 'default': False, 'description': '_metadata attribute'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/32', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/32', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/32/labels', 'id': 933188, 'node_id': 'MDk6TWlsZXN0b25lOTMzMTg4', 'number': 32, 'title': 'Contributions Welcome', 'description': 'Changes that would be nice to have in the next release. These issues are not blocking. They will be pushed to the next release if no one has time to fix them.', 'creator': {'login': 'jreback', 'id': 953992, 'node_id': 'MDQ6VXNlcjk1Mzk5Mg==', 'avatar_url': 'https://avatars.githubusercontent.com/u/953992?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jreback', 'html_url': 'https://github.com/jreback', 'followers_url': 'https://api.github.com/users/jreback/followers', 'following_url': 'https://api.github.com/users/jreback/following{/other_user}', 'gists_url': 'https://api.github.com/users/jreback/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jreback/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jreback/subscriptions', 'organizations_url': 'https://api.github.com/users/jreback/orgs', 'repos_url': 'https://api.github.com/users/jreback/repos', 'events_url': 'https://api.github.com/users/jreback/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jreback/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 1070, 'closed_issues': 719, 'state': 'open', 'created_at': '2015-01-13T10:53:19Z', 'updated_at': '2021-06-07T16:47:40Z', 'due_on': None, 'closed_at': None}",3,2021-06-05T16:59:07Z,2021-06-06T11:28:24Z,,NONE,,"#### Is your feature request related to a problem?

I wish the attrs could be retained when concat data frames.

```
d = {'col1': [1, 2], 'col2': [3, 4]}
df1 = pd.DataFrame(data=d)
df1.attrs = {1:1}
df2 = pd.DataFrame(data=d)
df2.attrs = {1:1}
pd.concat([df1, df2]).attrs
{}
```

#### Describe the solution you'd like

```
d = {'col1': [1, 2], 'col2': [3, 4]}
df1 = pd.DataFrame(data=d)
df1.attrs = {1:1}
df2 = pd.DataFrame(data=d)
df2.attrs = {1:1}
pd.concat([df1, df2]).attrs
{1: 1}
```

#### API breaking implications

N/A

#### Describe alternatives you've considered

N/A",,
https://api.github.com/repos/pandas-dev/pandas/issues/41827,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41827/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41827/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41827/events,https://github.com/pandas-dev/pandas/issues/41827,912342186,MDU6SXNzdWU5MTIzNDIxODY=,41827,BUG: DataFrame `isin` function randomly selects values (instead of using them all) when on Intel CPU and input is a torch Tensor,"{'login': 'SamuelTrew', 'id': 31927714, 'node_id': 'MDQ6VXNlcjMxOTI3NzE0', 'avatar_url': 'https://avatars.githubusercontent.com/u/31927714?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/SamuelTrew', 'html_url': 'https://github.com/SamuelTrew', 'followers_url': 'https://api.github.com/users/SamuelTrew/followers', 'following_url': 'https://api.github.com/users/SamuelTrew/following{/other_user}', 'gists_url': 'https://api.github.com/users/SamuelTrew/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/SamuelTrew/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/SamuelTrew/subscriptions', 'organizations_url': 'https://api.github.com/users/SamuelTrew/orgs', 'repos_url': 'https://api.github.com/users/SamuelTrew/repos', 'events_url': 'https://api.github.com/users/SamuelTrew/events{/privacy}', 'received_events_url': 'https://api.github.com/users/SamuelTrew/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2021-06-05T16:44:35Z,2021-06-05T16:44:35Z,,NONE,,"- [x ] I have checked that this issue has not already been reported.

- [x ] I have confirmed this bug exists on the latest version of pandas.

---

#### Code Sample, a copy-pastable example

```python
from typing import Tuple

import numpy as np
from pandas import DataFrame
from torch.tensor import Tensor
from torchvision import transforms, datasets
import torch

def __loadMNISTData() -> Tuple[DataFrame, DataFrame]:
    trans = transforms.Compose([transforms.ToTensor(), transforms.Normalize((0.5,), (1.0,))])
  
    # if not exist, download mnist dataset
    trainSet = datasets.MNIST(""data"", train=True, transform=trans, download=True)
    testSet = datasets.MNIST(""data"", train=False, transform=trans, download=True)
  
    # Scale pixel intensities to [-1, 1]
    xTrain: Tensor = trainSet.train_data
    xTrain = 2 * (xTrain.float() / 255.0) - 1
    # list of 2D images to 1D pixel intensities
    xTrain = xTrain.flatten(1, 2).numpy()
    yTrain = trainSet.train_labels.numpy()
  
    # Scale pixel intensities to [-1, 1]
    xtest: Tensor = testSet.test_data.clone().detach()
    xtest = 2 * (xtest.float() / 255.0) - 1
    # list of 2D images to 1D pixel intensities
    xTest: np.ndarray = xtest.flatten(1, 2).numpy()
    yTest: np.ndarray = testSet.test_labels.numpy()
  
    trainDataframe = DataFrame(zip(xTrain, yTrain))
    testDataframe = DataFrame(zip(xTest, yTest))
    trainDataframe.columns = testDataframe.columns = [""data"", ""labels""]

    return trainDataframe, testDataframe

def _filterDataByLabel( 
    labels: Tensor, trainDataframe: DataFrame, testDataframe: DataFrame
) -> Tuple[DataFrame, DataFrame]:
    print(""\nEntering _filterDataByLabel()"")
    print(f""labels: {labels}"")
    print(f""Lengths: {len(trainDataframe)}, {len(testDataframe)}"")
    trainDataframe = trainDataframe[trainDataframe[""labels""].isin(labels)]
    testDataframe = testDataframe[testDataframe[""labels""].isin(labels)]
    print(f""Lengths: {len(trainDataframe)}, {len(testDataframe)}"")
    print(f""Unique values: {trainDataframe['labels'].unique()}"")
    print(""Exiting _filterDataByLabel()\n"")
    return trainDataframe, testDataframe


data = __loadMNISTData()
labels = torch.tensor(range(10))
trainDataframe, testDataframe = self._filterDataByLabel(labels, *data)
```

#### Problem description

So for some reason, the labels that are passed into the `isin` function, aren't the same as the unique values.
E.g. I'll put 0-9 in and get back a random amount each time even though I set the seeds for python, np, torch and cuda.
If I change labels from a Tensor into a list then this no longer happens.

The weirdest part is that this doesn't happen on my AMD Ryzen 5600x but it does happen on 6th and 8th gen Intel i7 laptop CPUs.

#### Expected Output

The unique values should always be the same as the labels going in even if it's a tensor and no matter what CPU is used.

#### Output of ``pd.show_versions()``

These are the details from my laptop containing the 8th gen i7 cpu

<details>

INSTALLED VERSIONS
------------------
commit           : 2cb96529396d93b46abab7bbc73a208e708c642e
python           : 3.8.8.final.0
python-bits      : 64
OS               : Linux
OS-release       : 5.11.0-17-generic
Version          : #18-Ubuntu SMP Thu May 6 20:10:11 UTC 2021
machine          : x86_64
processor        : x86_64
byteorder        : little
LC_ALL           : None
LANG             : en_GB.UTF-8
LOCALE           : en_GB.UTF-8
pandas           : 1.2.4
numpy            : 1.19.4
pytz             : 2021.1
dateutil         : 2.8.1
pip              : 21.0.1
setuptools       : 52.0.0.post20210125
Cython           : 0.29.23
pytest           : 6.2.3
hypothesis       : None
sphinx           : 4.0.1
blosc            : None
feather          : None
xlsxwriter       : 1.3.8
lxml.etree       : 4.6.3
html5lib         : 1.1
pymysql          : None
psycopg2         : None
jinja2           : 2.11.3
IPython          : 7.22.0
pandas_datareader: None
bs4              : 4.9.3
bottleneck       : 1.3.2
fsspec           : 0.9.0
fastparquet      : None
gcsfs            : None
matplotlib       : 3.3.2
numexpr          : 2.7.3
odfpy            : None
openpyxl         : 3.0.7
pandas_gbq       : None
pyarrow          : None
pyxlsb           : None
s3fs             : None
scipy            : 1.6.0
sqlalchemy       : 1.4.15
tables           : 3.6.1
tabulate         : None
xarray           : None
xlrd             : 2.0.1
xlwt             : 1.3.0
numba            : 0.53.1
None

</details>
",,
https://api.github.com/repos/pandas-dev/pandas/issues/41826,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41826/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41826/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41826/events,https://github.com/pandas-dev/pandas/issues/41826,912311880,MDU6SXNzdWU5MTIzMTE4ODA=,41826,"ENH: Allow different senses of ""distance"" for method=nearest indexing","{'login': 'WardBrian', 'id': 31640292, 'node_id': 'MDQ6VXNlcjMxNjQwMjky', 'avatar_url': 'https://avatars.githubusercontent.com/u/31640292?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/WardBrian', 'html_url': 'https://github.com/WardBrian', 'followers_url': 'https://api.github.com/users/WardBrian/followers', 'following_url': 'https://api.github.com/users/WardBrian/following{/other_user}', 'gists_url': 'https://api.github.com/users/WardBrian/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/WardBrian/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/WardBrian/subscriptions', 'organizations_url': 'https://api.github.com/users/WardBrian/orgs', 'repos_url': 'https://api.github.com/users/WardBrian/repos', 'events_url': 'https://api.github.com/users/WardBrian/events{/privacy}', 'received_events_url': 'https://api.github.com/users/WardBrian/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,2,2021-06-05T15:26:36Z,2021-06-05T17:37:57Z,,NONE,,"#### Is your feature request related to a problem?

`Index.get_loc` with the method keyword has been quite useful for me, but I often find myself using data (e.g. atmospheric pressure levels) where the truest sense of the word 'nearest' is actually the closest value in log(p), not the normal number line. 

#### Describe the solution you'd like

My first thought was to simply request a ""log_nearest"" option to the method parameter, but I think it is easier to get much more functionality essentially ""for free"" with a different construction:

Index.get_loc (and subsequently Index._get_nearest_indexer) could accept a parameter (Let's call it ""pre"", but I think there are certainly better options I haven't thought of) which is a ufunc of one variable, and apply that to the target values and left and right indexed values before calculating their distances.

e.g.:


```python
>>> idx = pd.Index([10, 0.1, 0.01])
>>> idx.get_loc(2.0, method='nearest')
1
>>> idx.get_loc(2.0, method='nearest', pre=np.log)
0
```

#### API breaking implications

This should not affect any existing usages of the API

#### Describe alternatives you've considered

An alternative solution to my specific problem is to store the index in the log-space version, but this is considerably less human-readable in general.

#### Additional context

Besides changing the signatures and documentation, I believe this change can primarily be implemented with edits to this section of the indexing code

https://github.com/pandas-dev/pandas/blob/2cb96529396d93b46abab7bbc73a208e708c642e/pandas/core/indexes/base.py#L3269-L3277

There may also need to be some additional code added to the higher-up functions to produce errors if this parameter is passed when method != ""nearest"", as I don't believe it makes sense in that context.

It is also worth noting that this has the potential to fail (e.g, if a point in the indexer is 0 or negative, the log function will not work). Pandas may want to trap those errors and report them differently, but a garbage-in-garbage-out disclaimer may be helpful in general",,
https://api.github.com/repos/pandas-dev/pandas/issues/41825,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41825/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41825/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41825/events,https://github.com/pandas-dev/pandas/pull/41825,912116016,MDExOlB1bGxSZXF1ZXN0NjYyMzEwNDI2,41825,REF: share wrapping in MultiIndex setops,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 71268330, 'node_id': 'MDU6TGFiZWw3MTI2ODMzMA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/MultiIndex', 'name': 'MultiIndex', 'color': '207de5', 'default': False, 'description': None}, {'id': 127681, 'node_id': 'MDU6TGFiZWwxMjc2ODE=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Refactor', 'name': 'Refactor', 'color': 'FCE94F', 'default': False, 'description': 'Internal refactoring of code'}]",open,False,,[],,3,2021-06-05T06:12:50Z,2021-06-07T15:13:00Z,,MEMBER,,"If we can push _wrap_mi_setop_result further down into wrap_setop_result (not at all trivial bc different setops have different desired behavior on empty results) then we can share most of the rest of the MultiIndex setops code.

This PR changes the levels in the result of an empty .difference:

```
mi = pd.MultiIndex.from_product([range(3), [""a"", ""b""]])
mi2 = mi.repeat(2)

>>> mi.difference(mi2)
MultiIndex([], )

>>> mi.difference(mi2).levels
FrozenList([[], []])   # <-- master
FrozenList([[0, 1, 2], ['a', 'b']])   # <-- PR
```

I think this makes more sense, as a .difference should always be dtype-preserving, which for MultiIndex corresponds to levels-preserving.

In both the PR and in master, .intersection is levels-preserving when the intersection is empty, but it is less obvious to me that this is desirable.  In particular, it is mutually exclusive with .intersection being commutative.  cc @phofl?
",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41825', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41825', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41825.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41825.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41824,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41824/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41824/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41824/events,https://github.com/pandas-dev/pandas/pull/41824,912109064,MDExOlB1bGxSZXF1ZXN0NjYyMzA0NjY4,41824,REF: de-duplicate Index._intersection + MultiIndex._intersection,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 71268330, 'node_id': 'MDU6TGFiZWw3MTI2ODMzMA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/MultiIndex', 'name': 'MultiIndex', 'color': '207de5', 'default': False, 'description': None}, {'id': 127681, 'node_id': 'MDU6TGFiZWwxMjc2ODE=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Refactor', 'name': 'Refactor', 'color': 'FCE94F', 'default': False, 'description': 'Internal refactoring of code'}]",open,False,,[],,0,2021-06-05T05:31:30Z,2021-06-07T15:12:59Z,,MEMBER,,With a bit more work I think we can further de-duplicate these methods.,,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/41824', 'html_url': 'https://github.com/pandas-dev/pandas/pull/41824', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/41824.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/41824.patch'}"
https://api.github.com/repos/pandas-dev/pandas/issues/41823,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/41823/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/41823/comments,https://api.github.com/repos/pandas-dev/pandas/issues/41823/events,https://github.com/pandas-dev/pandas/issues/41823,912106294,MDU6SXNzdWU5MTIxMDYyOTQ=,41823,BUG: MultiIndex.unique incorrect when NA value is present,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 71268330, 'node_id': 'MDU6TGFiZWw3MTI2ODMzMA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/MultiIndex', 'name': 'MultiIndex', 'color': '207de5', 'default': False, 'description': None}]",open,False,,[],,0,2021-06-05T05:13:47Z,2021-06-06T19:42:14Z,,MEMBER,,"drop_duplicates looks right, while unique (and _get_unique_index) keep a duplicate entry containing an NA value.  Example based on test_intersection_with_missing_values_on_both_sides.  The analogous problem crops up for every entry in nulls_fixture

```
nulls_fixture = np.nan
mi1 = pd.MultiIndex.from_arrays([[3, nulls_fixture, 4, nulls_fixture], [1, 2, 4, 2]])

>>> mi1.unique()
MultiIndex([(3.0, 1),
            (nan, 2),
            (4.0, 4),
            (nan, 2)],
           )

>>> mi1.drop_duplicates()
MultiIndex([(3.0, 1),
            (nan, 2),
            (4.0, 4)],
           )
```",,
